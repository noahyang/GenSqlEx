# GenSqlEx
用 java 编写的将 xls 表格文件中的数据转换为 sql 语句，并自动导入数据库的小工具（仅在 mac 系统上使用过，win 下使用可能需要自行调整局部代码）。dist 目录中包含了一个已经构建好的 jar 文件，可直接双击执行。或从命令行启动执行：java -jar GenSql_v1.1.jar，好处是可以看到执行时输出的日志。mac 系统上使用可按下快捷键（CMD + 1/2/3）弹出小程序使用相关的说明窗口（相关说明也有在下文中给出）。

##一、工具用途
将 xls 表格中的数据迁移到 sqlite 数据库文件中，方便程序使用。注：xls 便于编辑，但在程序中操作不方便；sqlite 数据库则正好相反。目前仅支持 sqlite 数据库，要支持其他数据库可自行扩展（在 xxx/utils 包中新增相关数据库的工具类，现在已经有 SqliteUtil 类了）。另外，印象中好像不支持 xlsx 文件。  

##二、如何使用
*.支持拽入单个 .desc 文件  
*.支持拽入单个文件夹（文件夹中可包含多个 .desc 文件）  
*.在拽入单个文件夹的情况下，  
还可以在该文件夹中新建一个名为 absPathDb.txt 的文件，在该文本文件中可以写上 sqlite 数据库所在的绝对路径，小程序将会在该 sqlite 数据库中执行所有新生成出来的 sql 语句  

##三、desc 文件的格式
.desc 文件和 MetaDesc 对象是一对一的关系。关于类型自动识别：程序会尝试将单元格中的数据转换为浮点数，如果转换成功就判定类型为数值，转换失败就判定类型为字符串！  
行1：xls 文件的绝对路径  
行2：表单名称  
行3：数据库表格名称  
行4：起始行号,结束行号  
行5：+:数字用 $ 表示，字符串用 @ 表示，$@ 都不加表示由程序自动识别类型（+:a$,b@,c）  

##四、desc 示例文件（base_book.desc）
\#第1行，xls文件的路径（以 “#” 开头的行为注释行）  
./usage/test.xls  
\#第2行，表单名  
Book  
\#第3行，数据库表名  
base_book  
\#第4行，起始行和结束行  
2,10  
\#第5行，需要将哪些列导入到数据库（以及各列的类型）  
+:a$,b@,c@,d$,e@,f$,g$,h@  

##五、关于命名
1.parsePos(itive)  
2.parseNeg(ative)  
3.GenSql <= Generate SQL  
4.desc(ription)  
5.$ 美元符，指代数字  
6.@ 指代字符串，参见 Objective C 字符串写法 @“noah.yang”  
7.# 注释行标识，参见 linux shell 注释写法

##六、RoadMap
2016.xxxx（to do）  
1.基于命令行式的设计，为用户选择留下空间  
2.集成日志库，优化报错机制

2016.0412  
1.优化、精简代码（MetaDesc，Parser）

2015.0614  
1.整理工程结构，新增 org.noah.gen.sql.core 包，将解析字符串的核心逻辑置入 Parser 类中  
2.确定思路，以后如果没有迫切的需求，不再尝试实现 parseNeg(ative) 这个分支方法  
3.desc 文件中新增注释功能，以 # 开头的行将被识别为注释行  
4.在工程根目录下新建 usage 目录，用于放置便于理解程序运作机制的一些数据文件  
5.完善 entry.Test 功能，将数据文件整合到工程中并以相对路径的方式去操作，使能方便安全的执行测试  
6.智能识别单元格中数据的类型将被作为常规用法，以方便 .desc 文件的书写（不用追加 $ 或 @ 字符了）

2015.0208  
1.新增处理完毕后抖动窗体作为提示的功能  
2.使支持拽入单个 .desc 文件或单个文件夹（文件夹中可包含多个 .desc 文件）  
3.安特定方式配置 sqlite 数据库绝对路径以后，支持自动执行新生成出来的 sql 脚本  
4.新增 RoadMap 模块，记载小程序的成长历程

2014.xxxx  
1.最初版本